apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: tridorian-ztna-gateway
  namespace: tridorian-ztna
  annotations:
    # networking.gke.io/certmap: "tridorian-ztna-certmap"
spec:
  gatewayClassName: gke-l7-regional-external-managed
  listeners:
  # Single HTTPS Listener on port 443 for all services
  - name: https
    protocol: HTTPS
    port: 443
    allowedRoutes:
      namespaces:
        from: Same
    tls:
         mode: Terminate
         options: 
           networking.gke.io/cert-manager-certs: tridorian-ztna-cert
    allowedRoutes:
      kinds:
      - kind: HTTPRoute
  # HTTP Listener on port 80 for redirect to HTTPS
  - name: http
    protocol: HTTP
    port: 80
    allowedRoutes:
      namespaces:
        from: Same
  addresses:
  - type: NamedAddress
    value: tridorian-ztna-ip